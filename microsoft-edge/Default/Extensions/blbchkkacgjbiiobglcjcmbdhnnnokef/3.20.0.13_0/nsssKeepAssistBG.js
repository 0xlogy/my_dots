(()=>{const{uiConstants:{MESSAGES:i},telemetryWrapper:n,constants:{URL_PARAMS_KEY:t}}=NSSS,{constants:{BROWSER_TYPE:{EDGE_CHROMIUM:a}},utils:{isNil:r},localizer:o,extensionAdapter:e}=SymBfw;class _{static get SEARCH_POINTS(){return{HP:"hp",DS:"ds"}}static get SEARCH_POINT_NAMES(){return{[this.SEARCH_POINTS.HP]:"Norton Home Page",[this.SEARCH_POINTS.DS]:"Norton Safe Search"}}static get SEARCH_POINT_TO_TELEMETRY_FEATURE_MAP(){return{[this.SEARCH_POINTS.HP]:n.searchFeature.DEFAULT_HOMEPAGE,[this.SEARCH_POINTS.DS]:n.searchFeature.DEFAULT_SEARCH_PROVIDER}}}NSSS.keepAssistBG=new class{constructor(){this.handleMessage=this.handleMessage.bind(this)}_findSearchPoint(e){let t=_.SEARCH_POINTS.HP;return t=NSSS.NSSSHelper.isYahooSERPPage(e)||NSSS.NSSSHelper.isIACSERPPage(e)?_.SEARCH_POINTS.DS:t}_getKeepAssistUIStrings(e){var t,S,s=SymBfw.globals.BROWSER,i=NSSS.uiConstants.KEEP_ASSIST_UI;return r(i)?{}:((t={}).title=o.getLocalizedString(i[s].title),t.keepText=o.getLocalizedString(i[s].keepText),t.keepButtonText=o.getLocalizedString(i[s].keepButtonText),t.done=o.getLocalizedString(i.done),S=_.SEARCH_POINT_NAMES[e],s===a?(s=i.descriptionTextEdge,t.descriptionText=o.getLocalizedStringWithFormat(s,[S])):({description1:s,description2:i}=i[e],s=o.getLocalizedString(s),i=o.getLocalizedStringWithFormat(i,[S]),t.descriptionText=s+" "+i),t)}_shouldShowReverseImage(e,t){return e===SymBfw.constants.os.MAC?"rtl"===t:"ltr"===t}_initKeepAssistUI(e){var e=this._findSearchPoint(e),t=SymBfw.localizer.getCurrentLanguageDirection(),S=SymBfw.utils.getOSType(),s={};return s.direction=t,s.productName=NSSS.constants.PRODUCT_NAME,s.strings=this._getKeepAssistUIStrings(e),s.searchPoint=e,s.showReverseImage=this._shouldShowReverseImage(S,t),s}_isDSPage(e){return!(!NSSS.NSSSHelper.isYahooSERPPage(e)&&!NSSS.NSSSHelper.isIACSERPPage(e)||!(e=new URL(e).searchParams).has(t.OCODE)||e.get(t.OCODE)!==NSSS.ocodeMgr.getDSOCode())}handleMessage(e,t,S){var s;if(!(r(e)||r(e.name)||r(S)||r(S.url)))switch(e.name){case i.KEEP_ASSIST_UI_INIT:t(this._initKeepAssistUI(S.url));break;case i.SHOULD_SHOW_DS_KEEP_ASSIST_POPUP:this._isDSPage(S.url)?(s=NSSS.globalSettings.getValue(NSSS.constants.IS_DSP_FIRST_LAUNCH),t({isDSPFirstLaunch:s=!!r(s)||s}),s&&NSSS.globalSettings.setValue(NSSS.constants.IS_DSP_FIRST_LAUNCH,!1)):t(null);break;case i.DONE_BUTTON_CLICKED:Object.values(_.SEARCH_POINTS).includes(e.searchPoint)&&n.sendKeepAssistContinueButtonClickedEvent(_.SEARCH_POINT_TO_TELEMETRY_FEATURE_MAP[e.searchPoint]);break;case i.KEEP_ASSIST_SHOWN:Object.values(_.SEARCH_POINTS).includes(e.searchPoint)&&n.sendKeepAssistShownEvent(_.SEARCH_POINT_TO_TELEMETRY_FEATURE_MAP[e.searchPoint])}}},NSSS.KeepAssistConstants=_,e.addMessageListener(NSSS.keepAssistBG.handleMessage)})();