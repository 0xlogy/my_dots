!function(t){"use strict";const{SEARCH_SUGGESTION_METADATA:o}=NSSS["constants"],{extensionAdapter:s,utils:{isNil:n}}=SymBfw,a=NSSS.uiConstants.MESSAGES;(t.NSSS=t.NSSS||{}).homePageController=new class{constructor(){this._preCachedSuggestion={},this._homePageMetadata=null}_constructHomePageMetaData(){return new Promise(function(e,a){SymBfw.extensionAdapter.sendMessage({name:NSSS.uiConstants.MESSAGES.GET_HOME_PAGE_METADATA},t=>{(s.getLastError()||n(t))&&a(null),e(t)})})}async init(){try{await NSSS.vendorSetup.getVendor(),this._homePageMetadata=await this._constructHomePageMetaData(),SymBfw.globals.BROWSER!==SymBfw.constants.BROWSER_TYPE.FIREFOX&&NSSS.bookmarksController&&(this._homePageMetadata.bookmarks=await NSSS.bookmarksController.getBookmarksData()),NSSS.mostVisitedSitesController&&(this._homePageMetadata.mostVisitedSites=await NSSS.mostVisitedSitesController.getTopSites(this._homePageMetadata.chickeletsDataJson.quicklinksData))}catch(t){return void SymBfw.logger.debug("Error in getting homepage metadata  - "+t)}n(this._homePageMetadata.navigatorLanguage)&&(SymBfw.logger.debug("navigator Language from BG is null"),this._homePageMetadata.navigatorLanguage=o.defaultLangCode),this._populateSuggestionParams()}getHomePageMetadata(){return this._homePageMetadata}_populateSuggestionParams(){var t=o[NSSS.constants.VENDOR];if(SymBfw.utils.isNil(t))throw new Error("Unsupported vendor name");var e=t.suggestionUrl,t=new URLSearchParams(t.queryParams),[a,s]=this._homePageMetadata.navigatorLanguage.split("-");NSSS.constants.VENDOR===NSSS.constants.IAC&&(a=n(s)?a:a+"_"+s.toLocaleUpperCase(),t.set(NSSS.constants.URL_PARAMS_KEY.HL,a)),this._searchAPIUrl=e,this._queryParams=t}_getSuggestionUrlByVendor(t){return NSSS.constants.VENDOR===NSSS.constants.IAC&&this._queryParams.set(NSSS.constants.URL_PARAMS_KEY.IAC_QUERY,t),""+this._searchAPIUrl+this._queryParams.toString()}async fetchSuggestions(t){if(SymBfw.utils.isNil(this._homePageMetadata))return SymBfw.logger.debug("HomePageController is not initialized. Please call init before calling fetchSuggestions"),[];if(this._preCachedSuggestion[t])return this._preCachedSuggestion[t];try{var e=this._getSuggestionUrlByVendor(t),[,a]=await(await SymBfw.utils.safeFetch(e)).json();return this._preCachedSuggestion[t]=a}catch(t){return SymBfw.logger.error("Unable to fetch the suggestion result due to "+t),[]}}async launchSearchTab(t){var e;SymBfw.utils.isNil(t)||(this._homePageMetadata=await this._constructHomePageMetaData(),e=this._homePageMetadata.isDarkModeSet,SymBfw.extensionAdapter.sendMessage({name:a.LAUNCH_SEARCH_TAB_WITH_URL,query:t,isDarkModeSet:e}))}}}(executionContext);